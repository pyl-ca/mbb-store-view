# 🚀 Mall Web 部署指南

## 📋 脚本说明

### 1. **upload.sh** - 上传脚本
- **作用**: 从本地上传文件到服务器
- **选项1**: 上传构建后的文件 (推荐，更快)
- **选项2**: 上传源码文件

### 2. **deploy.sh** - 服务器端部署脚本
- **作用**: 在服务器上执行Docker构建和部署
- **位置**: 服务器上执行

### 3. **deploy-remote.sh** - 一键远程部署
- **作用**: 从本地一键完成整个部署流程
- **包含**: 上传 + 构建 + 部署

## 🎯 推荐部署流程

### 方案A: 分步部署 (推荐)
```bash
# 1. 本地构建
npm run build

# 2. 上传构建文件
./upload.sh
# 选择: 1) 上传构建后的文件

# 3. SSH到服务器部署
ssh root@39.107.74.208
cd /code/mall-web
./deploy.sh
```

### 方案B: 一键部署
```bash
# 一键完成所有步骤
./deploy-remote.sh
```

## 🔧 当前配置

- **服务器**: 39.107.74.208
- **用户**: root
- **目录**: /code/mall-web
- **端口**: 80
- **访问**: http://39.107.74.208

## ⚠️ 注意事项

1. **Dockerfile**: 已优化为直接使用构建后的dist文件
2. **权限**: 脚本会自动设置文件权限
3. **CORS**: 需要确保后端服务正常运行
4. **备份**: Dockerfile.multi-stage 是多阶段构建的备份版本

## 🐛 常见问题

### 502 Bad Gateway
- 检查后端服务是否启动
- 检查端口9999是否开放

### CORS错误
- 确保nginx代理配置正确
- 检查后端CORS设置
